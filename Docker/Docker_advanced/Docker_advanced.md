# **Docker\_advanced**

**Вопрос 1**

Вы разрабатываете CI/CD пайплайн для сборки и публикации образов Docker. Вы заметили, что кэш для сборки теряется при переходе между этапами пайплайна, из\-за чего каждый новый этап заново пересобирает неизмененные слои.

Выберите верное решение проблемы.

1. Передача флага \--no-cache на каждом этапе пайплайна предотвратит потерю кэша, так как сборка будет полностью обновляться на каждом этапе  
2. Использование внешнего централизованного хранилища кэша позволит сохранить и повторно использовать кэш между этапами пайплайна  
3. Регулярное обновление базового образа поможет устранить проблемы с потерей кэша при сборке новых слоев  
4. Увеличение количества шагов в Dockerfile для разделения задач повысит производительность и сохранит кэш между этапами.  
5. Уменьшение количества шагов сборки ускорит процесс и минимизирует риск потери кэша между этапами

**Вопрос 2**

В вашем Dockerfile используется инструкция ADD для копирования файлов и извлечения архива:

FROM nginx:latest  
ADD /app.tar.gz /usr/share/nginx/html  
ADD /config/nginx.conf /etc/nginx/nginx.conf  
CMD \["nginx", "-g", "daemon off;"\]

Вы заметили, что сборка образа занимает больше времени, чем ожидалось, а размер образа увеличивается из\-за ненжных файлов. Вы внесли изменения.

После изменений:

1. Сборка образа стала занимать меньше времени.  
2. Размер образа уменьшился, так как больше нет ненужных файлов из архива.

Какие изменения были внесены?

1. Установка минимальной версии Nginx для уменьшения размера базового образа  
2. Использование ADD для всех операций, так как это универсальная инструкция  
3. Перемещение CMD перед инструкцией ADD для ускорения сборки  
4. Уменьшение размера образа, удаление архива после его извлечения в Dockerfile  
5. Замена ADD на COPY для копирования файлов и распаковка архива заранее

**Вопрос 3**

Вы разрабатываете приложение, состоящее из трех сервисов: frontend, backend и database. В Docker Compose файле для каждого сервиса назначена своя собственная сеть, а не общая. После запуска через Docker Compose frontend не может подключиться к backend, и в логах frontend появляются ошибки соединения.

Почему это происходит?

1. Отсутствие настройки volumes вызывает потерю данных, но не влияет на сетевое взаимодействие между контейнерами  
2. Bridge-сеть в Docker Compose не поддерживает DNS резолвинг, что делает невозможным взаимодействие сервисов  
3. Сервисы запущены в отдельных сетевых пространствах, что препятствует их взаимодействию друг с другом  
4. Отсутствие секции depends\_on приводит к случайному порядку запуска контейнеров, что блокирует их сетевое взаимодействие  
5. Отсутствие healthcheck приводит к попытке подключения frontend к backend до полной готовности последних

**Вопрос 4**

Ваше приложение использует два контейнера: API и Redis. Они должны быть изолированы от других контейнеров в системе, но при этом поддерживать прямое взаимодействие между собой. Вы настроили отдельную сеть, но контейнеры не могут подключиться друг к другу.

Почему возникала проблема?

1. Поскольку контейнеры не подключены к одной и той же сети, они не могут взаимодействовать друг с другом  
2. Один из контейнеров использует параметр \--network=host, нарушая изоляцию сети и взаимодействие с другими контейнерами  
3. В секции networks отсутствует явное указание имени сети, что мешает контейнерам подключаться к одной сети  
4. Для контейнеров не настроены алиасы в сети, что мешает их взаимодействию через DNS  
5. Контейнеры подключены к разным bridge-сетям, что мешает их взаимодействию

**Вопрос 5**

На продакшн-сервере контейнер web-analytics начал демонстрировать нестабильную работу, в недавнее время обновления контейнера не производилось: увеличились задержки в ответах приложения, CPU загружено на 100%. Логи не содержат ошибок, но работа сервиса ощутимо замедлена. При этом:

* Контейнер нельзя остановить для диагностики.  
* Интерактивный доступ внутрь контейнера запрещен по политике безопасности.

Какова наиболее вероятная причина проблем и правильный подход к диагностике?

1. Плохо написанный код вызывает высокую нагрузку на CPU, для ликвидации проблемы требуется переписать код  
2. Операционная система хоста стала источником проблемы сильного роста задержек, необходимо немедленно перезагрузить сервер и перезапустить все контейнеры заново  
3. Увеличение задержек в ответах связаны с неправильной настройкой сети контейнера, требуется переподключение к виртуальной сети через docker network connect  
4. Высокая нагрузка вызвана "зависшими" процессами внутри контейнера, их надо выявить с помощью анализа активных процессов через docker top и мониторинга ресурсов через docker stats  
5. Рост задержек происходит из\-за того, что контейнер исчерпал лимиты открытых файловых дескрипторов, необходимо увеличить параметр ulimit через перезапуск контейнера

**Вопрос 6**

На вашем сервере обнаружены контейнеры, которые:

* Имеют доступ ко всем устройствам хоста.  
* Могут выполнять любые системные вызовы.  
* Работают в одной сети с другими контейнерами без ограничений.

Это повышает риски безопасности контейнерной платформы. При этом сами контейнеры работают стабильно и без сбоев.

Какова главная причина уязвимости в изоляции этих контейнеров?

1. Контейнеры используют приватные пространства имен, но неправильно настроены ограничения cgroups на ресурсы  
2. Контейнеры были ограничены по CPU и памяти, но оставлены без настройки capabilities  
3. Контейнеры развернуты в режиме read-only, что снижает уровень угроз со стороны приложений  
4. Контейнеры используют bridge-сеть с закрытыми портами, но доступ к устройствам хоста остался открыт  
5. Контейнеры запущены с настройкой seccomp-профиля, что позволяет получить доступ ко всем хостовым устройствам

**Вопрос 7**

При работе с приложением, использующим Docker-контейнеры, вы заметили следующие факты:

1. Логи контейнеров не сохраняются на хостовой системе  
2. Конфликты записи между несколькими контейнерами, использующими общий том  
3. Появление дублирующихся или конфликтующих файлов при восстановлении из резервной копии

Какой аспект настройки данных в Docker мог вызвать эти проблемы?

1. Отсутствие ротации логов для предотвращения переполнения томов  
2. Отсутствие режима read/write разделения между контейнерами  
3. Использование анонимных (безымянных) томов без явного монтирования на хостовую систему  
4. Использование тома без предварительного монтирования на хост  
5. Неправильная структура хранения данных внутри тома

**Вопрос 8**

В кластере Docker с несколькими контейнерами возникли проблемы с производительностью приложения, которые проявляются в виде периодического замедления работы контейнеров.

Проблема не имеет явных ошибок в логах, но наблюдается ухудшение работы, связанное с повышенным использованием CPU, памяти или сетевого трафика.

Какой из факторов стал ключевым в затруднении диагностики?

1. Использование разных версий образов в production и staging  
2. Слишком медленно пишутся логи, из\-за чего при нагрузке они не успевают создаваться  
3. Неправильно выставленные лимиты ресурсов через Docker Compose  
4. Наличие большого количества временных контейнеров (dangling containers)  
5. Отсутствие систематического сбора метрик о потреблении ресурсов (CPU, память, сеть)

**Вопрос 9**

Вы разрабатываете CI/CD пайплайн для проекта с использованием Docker. Docker используется для создания и тестирования образов, а также для автоматической установки зависимостей.

Какие преимущества вам это даст?

1. Создает автоматически резервные копии данных на каждом этапе пайплайна  
2. Автоматически добавит все необходимые зависимости для тестов в образ  
3. Даст возможность сборки образов, а тесты будут выполняться на хост-системе  
4. Позволит запускать тесты в изолированных средах, идентичных боевым  
5. Исключит необходимость запуска тестов, так как контейнеры уже проверены

**Вопрос 10**

Как сканеры уязвимостей помогают в CI/CD?

1. Интегрируются в пайплайн и могут блокировать публикацию образов  
2. Обнаруживают только уязвимости, связанные с сетевыми атаками  
3. Ускоряют процесс деплоя, уменьшая количество проверок  
4. Автоматически исправляют уязвимости  
5. Интегрируются в CI/CD для мониторинга безопасности

**Вопрос 11**

В production-среде с множеством Docker-контейнеров были обнаружены следующие проблемы:

А. Несколько контейнеров начали использовать неожиданно высокий объем сетевого трафика, что привело к перегрузке сети.  
В. Логи показывают, что некоторые контейнеры пытаются получить доступ к ресурсам других контейнеров, к которым у них не должно быть доступа.  
С. Один из контейнеров начал выполнять команды, которые не были предусмотрены его функциональностью.  
В чем причина проблемы?

1. Использование изолированной bridge-сети с настроенными правилами firewall, что позволяет контролировать сетевой трафик контейнеров  
2. Отсутствие мониторинга сетевой активности контейнеров и использования инструментов для анализа трафика  
3. Запуск контейнеров с параметром \--privileged, что дает им полный доступ к хосту и другим контейнерам  
4. Использование пользовательских сетей Docker, но без ограничения доступа к критическим системным ресурсам хоста  
5. Использование устаревших образов с известными уязвимостями, которые могут быть эксплуатированы злоумышленниками

**Вопрос 12**

Как установка ограничения памяти для контейнера может предотвращать ошибки Out of Memory?

1. Автоматически перераспределяет ресурсы памяти между всеми контейнерами  
2. Позволяет выбранному контейнеру использовать swap-память без сильных ограничений  
3. Не дает перегружать хост, заставляя приложение эффективно использовать доступную память  
4. Уменьшает нагрузку на процессор контейнера, снижает у него потребление памяти  
5. Оптимизирует код приложения для более эффективного использования памяти

**Вопрос 13**

Приложение в Docker обрабатывает файлы большого объема, но при этом обработка выполняется медленно. Логи показывают, что файловая система контейнера ограничивает скорость чтения и записи данных. Это влияет на время выполнения операций и производительность всего приложения.

Что поможет оптимизировать обработку данных?

1. Настроить репликацию контейнера для распределения нагрузки  
2. Ограничить доступ контейнера к внешним ресурсам  
3. Удалить неиспользуемые файлы из контейнера  
4. Использовать тома Docker для ускорения работы с файлами  
5. Использовать новую bridge-сеть вместо стандартной сети Docker

**Вопрос 14**

Какое преимущество использования секции secrets перед передачей данных через общие тома (volumes)?

1. Docker управляет жизненным циклом секретов и ограничивает их доступность  
2. Секреты можно изменять динамически без перезапуска сервисов  
3. Секреты автоматически кэшируются для ускорения запуска контейнеров  
4. Тома требуют настройки сетевых политик для каждого контейнера  
5. Тома не поддерживают права доступа только для чтения

**Вопрос 15**

Вы настраиваете Docker Swarm для приложения, которое использует несколько секретов, таких как ключи API и пароли. После развертывания несколько сервисов не могут получить доступ к своим секретам, а логи указывают на отсутствие необходимых данных. Сервисы продолжают работать нестабильно, что приводит к сбоям в приложении и возможным нарушениям безопасности.

Как правильно настроить доступ к секретам, чтобы устранить затруднение?

1. Добавить секреты в сам файл Docker Compose  
2. Использовать общий том для передачи секретов между контейнерами  
3. Настроить автоматическую синхронизацию секретов через общий реестр  
4. Привязать секреты к конкретным сервисам, которые их используют  
5. Сохранить секреты в переменных окружения для каждого сервиса